local DSanimations = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local MiniFrame = Instance.new("Frame")
local DragHandle = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local ExpandButton = Instance.new("TextButton")
local ContentFrame = Instance.new("ScrollingFrame")
local WeirdMove = Instance.new("TextButton")

-- Цветовая схема
local COLORS = {
    RED = Color3.fromRGB(170, 0, 0),
    BLACK = Color3.fromRGB(20, 20, 20),
    WHITE = Color3.fromRGB(255, 255, 255),
    GRAY = Color3.fromRGB(80, 80, 80)
}

-- Базовое GUI
DSanimations.Name = "DSanimations"
DSanimations.Parent = game:GetService("CoreGui")
DSanimations.ResetOnSpawn = false -- Отключаем респавн

-- Главное окно
MainFrame.Name = "MainFrame"
MainFrame.Parent = DSanimations
MainFrame.BackgroundColor3 = COLORS.BLACK
MainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 500, 0, 400)
MainFrame.Visible = false

-- Миниатюрный фрейм
MiniFrame.Name = "MiniFrame"
MiniFrame.Parent = DSanimations
MiniFrame.BackgroundColor3 = COLORS.RED
MiniFrame.Size = UDim2.new(0, 100, 0, 30)
MiniFrame.Position = UDim2.new(0.5, -50, 0, 10)
MiniFrame.Visible = true

-- Элементы управления
DragHandle.Name = "DragHandle"
DragHandle.Parent = MainFrame
DragHandle.BackgroundColor3 = COLORS.RED
DragHandle.Size = UDim2.new(1, 0, 0, 30)
DragHandle.Text = "DSanimations ★ Kotik243h"
DragHandle.TextColor3 = COLORS.WHITE
DragHandle.TextSize = 14

CloseButton.Name = "CloseButton"
CloseButton.Parent = MainFrame
CloseButton.BackgroundColor3 = COLORS.GRAY
CloseButton.Position = UDim2.new(1, -30, 0, 5)
CloseButton.Size = UDim2.new(0, 25, 0, 20)
CloseButton.Text = "—"
CloseButton.TextColor3 = COLORS.WHITE

ExpandButton.Name = "ExpandButton"
ExpandButton.Parent = MiniFrame
ExpandButton.BackgroundColor3 = COLORS.GRAY
ExpandButton.Size = UDim2.new(0, 25, 0, 20)
ExpandButton.Position = UDim2.new(1, -30, 0, 5)
ExpandButton.Text = "+"
ExpandButton.TextColor3 = COLORS.WHITE

-- Контентная область
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundColor3 = COLORS.BLACK
ContentFrame.Position = UDim2.new(0, 10, 0, 40)
ContentFrame.Size = UDim2.new(1, -20, 1, -50)
ContentFrame.CanvasSize = UDim2.new(0, 0, 2, 0)

-- Кнопка анимации
WeirdMove.Parent = ContentFrame
WeirdMove.Text = "WEIRD MOVE"
WeirdMove.Size = UDim2.new(1, -20, 0, 50)
WeirdMove.Position = UDim2.new(0, 10, 0, 10)
WeirdMove.BackgroundColor3 = COLORS.GRAY
WeirdMove.TextColor3 = COLORS.WHITE

-- Логика перетаскивания
local dragging, dragInput, dragStart, startPos

local function updateInput(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end

DragHandle.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

DragHandle.InputChanged:Connect(updateInput)
game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(
            startPos.X.Scale, 
            startPos.X.Offset + delta.X,
            startPos.Y.Scale, 
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- Управление окнами
CloseButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    MiniFrame.Visible = true
end)

ExpandButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = true
    MiniFrame.Visible = false
end)

-- Защита от смерти персонажа
local humanoid

local function loadAnimations()
    if game.Players.LocalPlayer.Character then
        humanoid = game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
        if humanoid then
            -- Инициализация анимаций
            local anim = Instance.new("Animation")
            anim.AnimationId = "rbxassetid://215384594"
            weirdAnim = humanoid:LoadAnimation(anim)
        end
    end
end

loadAnimations()

game.Players.LocalPlayer.CharacterAdded:Connect(function()
    loadAnimations()
end)

-- Логика анимации
WeirdMove.MouseButton1Click:Connect(function()
    if humanoid and humanoid.Health > 0 then
        if not weirdAnim.IsPlaying then
            weirdAnim:Play()
            WeirdMove.BackgroundColor3 = COLORS.RED
        else
            weirdAnim:Stop()
            WeirdMove.BackgroundColor3 = COLORS.GRAY
        end
    end
end)

-- Визуальные эффекты
game:GetService("RunService").Heartbeat:Connect(function()
    local t = tick()
    WeirdMove.Rotation = math.sin(t * 3) * 1.5
    MiniFrame.BackgroundColor3 = Color3.fromHSV((t*0.3)%1, 0.7, 0.8)
end)
